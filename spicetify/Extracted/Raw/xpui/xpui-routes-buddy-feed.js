<<<<<<< HEAD
"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{31280:(e,i,n)=>{n.r(i),n.d(i,{default:()=>Di});var a=n(98866),s=n(30758),t=n(23706),r=n(85996),l=n(8539),c=n(72002),d=n(29158),o=n(92503),u=n(20947),f=n(85856),m=n(38763),x=n(68262),v=n(85670),h=n(79464),j=n(58400),g=n(73547),b=n(58184),p=n(95477),N=n(90473),y=n(48346),C=n(79621),k=n(48673),S=function(e){return e[e.LOADING=0]="LOADING",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e}({});n(9555),n(62980),n(75231),n(21977);var R=n(8159),E=n(76285),w=n(22073),L=n(29969),I=n(52618),T=n.n(I),O=(n(63051),n(41669),n(42363),n(58634)),A=(n(83603),n(76133),n(82368),n(45803),n(58470),n(97500)),B=n.n(A),D=n(90441),P=n(61270),_=n(79055),F=n(3819),U=n(72185);const Q="jmX3vUTqdroySvWZjafY",z="sy4ejRXtpCCm2rnVCsBh",M="HO7uMcLeIpPBUBfBUF7f",Y="EWRfCzpvY8DGEJrpWuib";var W=n(86070),Z=function(e){var i=e.name,n=e.following,r=e.imageUrl,d=e.uri,o=(0,F.f)(),u=(0,x.W)(),f=s.createRef(),m=(0,s.useState)(n),v=(0,a.A)(m,2),h=v[0],j=v[1];(0,U.N)(_.mc.OPERATION_COMPLETE,(function(e){if(e.data.uris.includes(d))switch(e.data.operation){case _.JK.FOLLOW_USER:j(!0);break;case _.JK.UNFOLLOW_USER:j(!1)}}));var g=(0,s.useCallback)((function(){h?o.unfollowUsers([d]):(o.followUsers([d]),u({intent:"follow",type:"click",itemIdSuffix:"buddyfeed"})),f.current&&f.current.blur()}),[h,f,d,o,u]);return(0,s.useEffect)((function(){j(n)}),[n]),(0,W.jsxs)("div",{className:Q,children:[(0,W.jsx)(P.e,{label:i,width:40,userIconSize:"small",images:(0,s.useMemo)((function(){return[{width:40,height:40,url:r}]}),[r])}),(0,W.jsxs)("div",{className:B()(z,"ellipsis-one-line"),children:[(0,W.jsx)(b.E,{as:"p",variant:"bodySmallBold",className:"ellipsis-one-line",children:i}),h&&(0,W.jsx)(b.E,{as:"p",variant:"marginal",className:"ellipsis-one-line",children:l.Ru.get("following")})]}),(0,W.jsx)("div",{className:M,children:(0,W.jsx)(c.a,{className:Y,size:"sm",ref:f,onClick:g,ariaLabel:h?l.Ru.get("buddy-feed.button.remove-friend"):l.Ru.get("buddy-feed.button.add-friend"),icon:h?D.M:t.k})})]})};const H="rnrQ23E2_XN8d7ZBqsTp";function G(e){var i=e.facebookFriends;return(0,W.jsx)("div",{className:H,children:i.map((function(e){var i=e.uri,n=e.following,a=e.title,s=e.image;return(0,W.jsx)(Z,{uri:i,name:a,imageUrl:s,following:n},"fb-friend-".concat(i))}))})}n(50932);const J="eGd6xxi5CmL4GBZoEnMi";function V(){return(0,W.jsx)("div",{className:J,children:Array(20).fill(0).map((function(e,i){return(0,W.jsx)(w.Y,{isLoading:!0,charCount:100,as:"p",variant:"titleSmall"},i)}))})}const X="wFKGrAXEW5REryzTsDIb",q="Na5e2ZRRgwg_8duvoFyo",K="sgUgGj3mSuAdpNv8AyYQ",$="ePqfotL3LdZXKKlsSp1G",ee="Jxd3auUMXwsqpPcizfbP",ie="KPTOp08r5MTyYMmcTBcM",ne="uaVnv8WopjiEsa4Hpl_r",ae="eI_jytcKj_NBe3vo5mvx",se="CxoJJA7kFeXzEeE2R6f7";var te=function(e){var i,n,t,r,d,o,u,f=e.onBackButtonClick,m=(0,s.useState)(""),x=(0,a.A)(m,2),v=x[0],h=x[1],j=(i=v,r=(0,k.C)(),d=i.trim().toLowerCase(),o=(0,O.I)({queryKey:["useFacebookFriends"],queryFn:(t=(0,L.A)(T().mark((function e(){var i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fetchFacebookFriends();case 2:return i=e.sent,e.abrupt("return",i.sort((function(e,i){return e.title>i.title?1:-1})));case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}),u=o.data,{isLoading:o.isLoading,friends:null!==(n=null==u?void 0:u.filter((function(e){return-1!==e.title.trim().toLowerCase().indexOf(d)})))&&void 0!==n?n:[]}),p=j.isLoading,y=j.friends,C=(0,R.YQ)((function(e){h(e.target.value)}),100),S=(0,s.useCallback)((function(e){null!==e&&e.focus()}),[]);return(0,W.jsxs)("div",{className:X,children:[(0,W.jsx)(c.a,{ariaLabel:l.Ru.get("buddy-feed.button.back"),onClick:f,ref:S,className:q,icon:g.g,size:"sm",testId:"back-to-friends"}),(0,W.jsxs)("div",{className:K,children:[(0,W.jsx)("div",{className:$,children:(0,W.jsx)(N.G,{className:ee,size:"large"})}),(0,W.jsx)("div",{className:ie,children:p?(0,W.jsx)(w.Y,{isLoading:!0,charCount:25,as:"p",variant:"bodySmall"}):(0,W.jsx)(b.E,{as:"p",variant:"bodySmall",children:l.Ru.get("buddy-feed.number-of-friends",y.length)})})]}),p?(0,W.jsx)(V,{}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:ne,children:[(0,W.jsx)(E.C,{className:se,size:"small",role:"presentation"}),(0,W.jsx)("input",{onChange:C,className:ae,placeholder:l.Ru.get("buddy-feed.find-in-playlists")})]}),(0,W.jsx)(G,{facebookFriends:y})]})]})},re=n(82543);function le(e){var i=e.isOpen,n=e.onClose,a=e.onConfirm;return(0,W.jsx)(re.T,{onClose:n,"aria-label":l.Ru.get("web-player.buddy-feed.connect-with-facebook-title"),onConfirm:a,titleText:l.Ru.get("web-player.buddy-feed.connect-with-facebook-title"),descriptionText:l.Ru.get("web-player.buddy-feed.connect-with-facebook-description"),cancelText:l.Ru.get("queue.cancel-button"),confirmText:l.Ru.get("web-player.buddy-feed.connect-button"),isOpen:i})}const ce="PWrXmnQx41DSpIe1D_nH",de="AzWuuC6HtstaRZSyCs3n",oe="VrSCtYccvuQZG9aY627D",ue="mSFjqxw0tzcwc0ZCN1YP",fe="Q9ZfLJTBuMTFz4HsBThH",me="_76MQUYO_OcYkQOL1dlw",xe="TOY_wX6BMTOxtaEcJX2X",ve="A_pGgx3U5jNWUM85mJLQ",he="ffXJrzSIg2CXoGlxDi0v",je="zmmtwzKSFa5srnl7Ftq2";var ge=function(e){var i=(0,x.W)(),n=e.onBackButtonClick,t=e.feedIsEmpty,r=e.goToAddFriends,d=void 0!==r&&r,o=function(){var e=(0,k.C)(),i=(0,s.useState)(S.LOADING),n=(0,a.A)(i,2),t=n[0],r=n[1];return(0,s.useEffect)((function(){return e.subscribeToFacebookConnectionState((function(e){r(e.connection?S.CONNECTED:S.DISCONNECTED)})).cancel}),[e]),t}(),u=(0,k.C)(),f=(0,s.useState)(!1),m=(0,a.A)(f,2),v=m[0],h=m[1],j=(0,s.useState)(!1),R=(0,a.A)(j,2),E=R[0],w=R[1],L=(0,s.useState)(!1),I=(0,a.A)(L,2),T=I[0],O=I[1],A=(0,s.useCallback)((function(e){null!==e&&e.focus()}),[]),B=(0,s.useCallback)((function(){location.reload()}),[]);if(E)return(0,W.jsxs)("div",{className:he,children:[(0,W.jsx)(c.a,{onClick:n,ref:A,className:oe,ariaLabel:l.Ru.get("buddy-feed.button.back"),icon:g.g,size:"sm"}),(0,W.jsxs)("div",{className:je,children:[(0,W.jsx)(b.E,{as:"h1",variant:"bodyMediumBold",className:de,children:l.Ru.get("error-dialog.generic.header")}),(0,W.jsx)(b.E,{as:"p",variant:"bodySmall",className:ue,children:l.Ru.get("error-dialog.generic.body")}),(0,W.jsx)(p.$,{colorSet:"invertedLight",onClick:B,children:l.Ru.get("error.reload")})]})]});var D=(d||T)&&o===S.CONNECTED;return(0,W.jsxs)("div",{className:ce,children:[D&&(0,W.jsx)(te,{onBackButtonClick:function(){t&&O(!1),n()}}),!D&&(0,W.jsxs)("div",{className:me,children:[(0,W.jsx)(c.a,{ariaLabel:l.Ru.get("buddy-feed.button.back"),onClick:n,className:oe,ref:A,icon:g.g,size:"sm"}),(0,W.jsx)(b.E,{as:"h1",variant:"bodyMediumBold",className:de,children:l.Ru.get("buddy-feed.friend-activity")}),(0,W.jsx)(b.E,{as:"p",variant:"bodySmall",className:ue,children:l.Ru.get("buddy-feed.facebook.connect-with-friends-default")}),(0,W.jsx)("div",{className:xe,children:(0,W.jsx)(p.$,{className:ve,size:"small",iconLeading:N.G,UNSAFE_colorSet:(0,y.mA)("#2374E1",C.white),onClick:function(){i({intent:"connect-to-facebook",type:"click",itemIdSuffix:"buddyfeed"}),o!==S.CONNECTED?h(!0):O(!0)},children:l.Ru.get("buddy-feed.facebook.button")})}),(0,W.jsx)(b.E,{as:"p",variant:"marginal",className:fe,children:l.Ru.get("buddy-feed.facebook.disclaimer")}),(0,W.jsx)(le,{isOpen:v,onClose:function(){h(!1)},onConfirm:function(){u.connectToFacebook().then((function(){O(!0),h(!1)})).catch((function(){w(!0)}))}})]})]})},be=n(67187),pe=n(87428);const Ne="jGcEaPyhr1c_janM2uRF",ye="OemaZktMXaRcYQ5bcfLZ",Ce="o5IJsOJEWBEyxtPVVVqQ",ke="yHlSWaHkqZHm5mcY8ZFh",Se="toPt7VOT_PiDx5Gj3SM2",Re="xU4sacBisQneHoQeHMP5",Ee="srjSlmxMGzXnJBc32BJa",we="lju7xv10a5Y5Z8h8CcKJ",Le="jr794VV4i2iUBRhfvS5i",Ie="KE3gK5ccLz2gL3dhJ4BW",Te="pO2rsGFqUdaNhpLrif21",Oe="Ydxgl4Y23orfVVVI9O2k",Ae="VhqWrkzIrJrvdyj7ZXMd",Be="T3liC_3fbMOTilR4HHKD",De="W_tr6AMQB9Chbc9bCS9w",Pe="yDdNxgieZmqjgHQCW3UE",_e="iRrzzadYGo2MSuVhmVCn",Fe="_8yOZhEqs2xrYtslnNcDw",Ue="aikUDGtqRnCX0ZwYHDUW",Qe="T_HXMW6n5qsbLbPTr1GS",ze="tYswKV9PmtTCv62LOPIV",Me="GlDNRQ2w0t4h9WBI4GgN",Ye="BQGSV5BvuAaJ5rmFAXLp",We="ZLbFjRdp1AMXebZH6UWM",Ze="jhtyHt6d9vbxK6VtCI7a",He="oCaGCB13zdReRutfBS8_",Ge="MR1n58Qu0kPorQtveOCQ",Je="y10vXronmQ6eYMlJrIp3";var Ve=function(e){var i=e.showOnlineIndicator;return(0,W.jsxs)("div",{className:ze,children:[(0,W.jsxs)("div",{className:Me,children:[(0,W.jsx)(pe.v,{size:"medium"}),i?(0,W.jsx)("div",{className:Ye}):null]}),(0,W.jsxs)("div",{className:We,children:[(0,W.jsx)("div",{className:B()(Ze,He)}),(0,W.jsx)("div",{className:Ze}),(0,W.jsx)("div",{className:Ze})]})]})},Xe=function(){return(0,W.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:Ue,children:[(0,W.jsx)(b.E,{as:"p",className:Qe,children:l.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,W.jsx)(Ve,{showOnlineIndicator:!0}),(0,W.jsx)(Ve,{showOnlineIndicator:!0}),(0,W.jsx)(Ve,{}),(0,W.jsx)(b.E,{as:"p",className:Qe,children:l.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,W.jsx)(be.N_,{to:"/preferences",className:Ge,children:(0,W.jsx)(p.$,{colorSet:"invertedLight",className:Je,children:l.Ru.get("desktop.settings.settings")})})]})},qe=(n(23833),n(72757)),Ke=n(96096),$e=n(57824),ei=n(72209),ii=(n(60989),n(39350),n(96839)),ni=n(87349),ai=n(16493),si=n(64961),ti=n(4717),ri=n(90751),li=n(87393),ci=n(20610),di=n(80047),oi=n(72135),ui=n(37302),fi=n(5141),mi=n(93697),xi=n(60093),vi=n(22058),hi=n(87247),ji=n(79834),gi=function(e){var i=e.timestamp;return e.isNowPlaying?(0,W.jsx)(d.Zp,{label:l.Ru.get("time.now"),children:(0,W.jsx)(hi.A,{"aria-label":l.Ru.get("time.now"),size:"small"})}):(0,W.jsx)("span",{children:(0,ji.Z)(i)})},bi=function(e){return Date.now()-e<9e5},pi=function(e,i){var n;switch(null===(n=(0,ii.o_)(e))||void 0===n?void 0:n.type){case ii.NQ.PLAYLIST:case ii.NQ.PLAYLIST_V2:return(0,W.jsx)(ti.W,{uri:e});case ii.NQ.EPISODE:case ii.NQ.SHOW:return(0,W.jsx)(ri.H,{uri:e});case ii.NQ.ALBUM:return(0,W.jsx)(ai.h,{uri:e,artistUri:i});case ii.NQ.ARTIST:return(0,W.jsx)(si.t,{uri:e});default:return null}},Ni=function(e){switch(e){case ii.NQ.ALBUM:return vi.c.ALBUM;case ii.NQ.ARTIST:return vi.c.ARTIST;case ii.NQ.SHOW:return vi.c.SHOW;case ii.NQ.EPISODE:return vi.c.EPISODE;case ii.NQ.PLAYLIST:case ii.NQ.PLAYLIST_V2:return vi.c.PLAYLIST;default:return}},yi=function(e){var i,n,a,t,r,c,d,o,u,f,m,v,j,g,p,N,y,C=e.show,k=void 0===C||C,S=e.spec,R=e.friend,E=(0,s.useMemo)((function(){return R.user.imageUrl?[{url:R.user.imageUrl,width:0,height:0}]:[]}),[R.user.imageUrl]),w=(0,x.W)(),L=(0,h.s)(),I=R.track,T=I.uri,O=(0,xi.P)({uri:T},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),A=O.togglePlay,D=O.isPlaying,_=O.isActive,F=(0,ii.o_)(null===(i=I.context)||void 0===i?void 0:i.uri),U=null==F?void 0:F.type,Q=(0,s.useCallback)((function(){A(),w({intent:D?"pause":"play",type:"click",itemIdSuffix:"buddyfeed_play",targetUri:T});var e=S.friendRowFactory().playButtonFactory();_?D?L.logInteraction(e.hitPause({itemToBePaused:T})):L.logInteraction(e.hitResume({itemToBeResumed:T})):L.logInteraction(e.hitPlay({itemToBePlayed:T}))}),[w,D,T,S,_,A,L]),z=(0,s.useCallback)((function(e,i){L.logInteraction(S.friendRowFactory().friendRowLinkFactory({identifier:e}).hitUiNavigate({destination:i}))}),[L,S]),M=(0,ui.P)({itemUris:[T],dragLabelText:I.name}),Y=M.draggable,Z=M.onDragStart,H=(0,ui.P)({itemUris:[null===(n=I.artist)||void 0===n?void 0:n.uri],dragLabelText:null===(a=I.artist)||void 0===a?void 0:a.name}),G=H.draggable,J=H.onDragStart,V=(0,ui.P)({itemUris:[null===(t=I.context)||void 0===t?void 0:t.uri],dragLabelText:null===(r=I.context)||void 0===r?void 0:r.name}),X=V.draggable,q=V.onDragStart;return k?(0,W.jsxs)("div",{className:B()(Ne),children:[(0,W.jsx)(ni.h,{menu:pi(null===(c=I.context)||void 0===c?void 0:c.uri,null===(d=I.artist)||void 0===d?void 0:d.uri),children:(0,W.jsxs)("div",{className:Re,children:[(0,W.jsx)(P.e,{label:R.user.name,width:40,userIconSize:"small",images:E,withBadge:bi(R.timestamp)}),(0,W.jsx)(oi.x,{className:Ee,iconClassName:we,isPlaying:D,isLocked:!1,onClick:Q,playAriaLabel:D?l.Ru.get("pause"):"".concat(l.Ru.get("play")," ").concat(I.artist.name," ").concat(I.name)})]})}),(0,W.jsxs)("div",{className:B()(Le),children:[(0,W.jsxs)("div",{className:Ie,children:[(0,W.jsx)(b.E,{as:"p",variant:"bodySmallBold",className:B()(Te,"ellipsis-one-line"),children:(0,W.jsx)(mi.pZ,{value:"/buddyfeed_user_profile",children:(0,W.jsx)(ni.h,{menu:(0,W.jsx)(ci.B,{uri:R.user.uri}),children:(0,W.jsx)(di.N,{title:R.user.name,to:R.user.uri,dir:"auto",onClick:function(){return z("profile_link",R.user.uri)},children:R.user.name})})})}),(0,W.jsx)(b.E,{as:"p",variant:"marginal",className:B()(Oe),children:(0,W.jsx)(gi,{timestamp:R.timestamp,isNowPlaying:bi(R.timestamp)})})]}),(0,W.jsxs)(b.E,{as:"p",variant:"marginal",className:Ae,children:[(0,W.jsx)(mi.pZ,{value:"/buddyfeed_track",children:(0,W.jsx)(ni.h,{menu:(0,W.jsx)(li.P,{uri:I.uri,contextUri:null===(o=I.context)||void 0===o?void 0:o.uri,albumUri:null===(u=I.album)||void 0===u?void 0:u.uri,artists:[I.artist]}),children:(0,W.jsx)(di.N,{title:I.name,to:T,className:"ellipsis-one-line",dir:"auto",draggable:Y,onDragStart:Z,onClick:function(){return z("track_link",T)},children:I.name})})}),(0,W.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,W.jsx)(mi.pZ,{value:"/buddyfeed_artist",children:(0,W.jsx)(ni.h,{menu:I.artist?(0,W.jsx)(si.t,{uri:I.artist.uri}):null,children:(0,W.jsx)(di.N,{title:null===(f=I.artist)||void 0===f?void 0:f.name,to:null===(m=I.artist)||void 0===m?void 0:m.uri,className:"ellipsis-one-line",dir:"auto",draggable:G,onDragStart:J,onClick:function(){var e;return z("artist_link",null===(e=I.artist)||void 0===e?void 0:e.uri)},children:null===(v=I.artist)||void 0===v?void 0:v.name})})})]}),(0,W.jsx)(b.E,{as:"p",variant:"marginal",className:B()("ellipsis-one-line",De),children:(0,W.jsx)(mi.pZ,{value:"/buddyfeed_context",children:(0,W.jsx)(ni.h,{menu:pi(null===(j=I.context)||void 0===j?void 0:j.uri,null===(g=I.artist)||void 0===g?void 0:g.uri),children:(0,W.jsxs)(di.N,{title:null===(p=I.context)||void 0===p?void 0:p.name,to:null===(N=I.context)||void 0===N?void 0:N.uri,className:Pe,draggable:X,onDragStart:q,onClick:function(){var e;return z("context_link",null===(e=I.context)||void 0===e?void 0:e.uri)},children:[(0,W.jsx)(fi.s,{type:Ni(U),iconSize:16,className:Be}),(0,W.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:null===(y=I.context)||void 0===y?void 0:y.name})]})})})})]})]},R.user.uri):null};function Ci(e){var i=e.friends,n=e.spec,t=(0,Ke.D)().currentSession,r=(0,ei.y)(),l=(0,s.useState)(!0),c=(0,a.A)(l,2),d=c[0],o=c[1],u=!(null!=t&&t.active)&&r&&d&&(0,W.jsx)("li",{className:Ce,children:(0,W.jsx)($e.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:function(){return o(!1)}})},"start-jam-button");return(0,W.jsx)(qe.ZI,{flipKey:i.map((function(e){return e.user.uri})).join(""),children:(0,W.jsxs)("ul",{className:ye,children:[u,i.map((function(e,i){return(0,W.jsx)(qe.lf,{flipId:e.user.uri,children:(0,W.jsx)("li",{children:(0,W.jsx)(yi,{friend:e,show:i<100,spec:n},e.user.uri)})},e.user.uri)}))]})})}var ki=n(95079),Si=n(94079);const Ri="VTOHA2pQ5UOAQhut6swb",Ei="y02ezh9Bcfm_61XcxvOS",wi="rb6j61g6Avhg8RARvz3b",Li="xDW2awz1Oc3Khs6Wsn8g",Ii="MOKoNTiYkc9jh0xhfoZH",Ti="gOHEpGu2st4QQtJy8OPw",Oi="ijngDXlnRFRYySzwV5JJ",Ai="oNiqjPtyJeYH6LqZlnVa";var Bi=function(e){var i=e.children,n=e.page,a=e.nodeRef,s=0===n,t=i.filter((function(e,i){return i!==n}));return(0,W.jsx)(ki.A,{component:null,children:t.map((function(e){return(0,W.jsx)(Si.A,{in:s,timeout:500,nodeRef:a,classNames:{enter:s?Ri:Ii,enterActive:s?Ei:Ti,exit:s?wi:Oi,exitActive:s?Li:Ai},children:e},s?"first-page":"second-page")}))})};const Di=function(e){var i=e.friends,n=(0,x.W)(),g=(0,h.s)(),b=(0,j.r)(r.W,{}).spec,p=(0,s.useRef)(null),N=(0,s.useRef)(null);(0,s.useEffect)((function(){n({intent:"view",type:"impression",itemIdSuffix:"buddyfeed"})}),[n]),(0,s.useEffect)((function(){g.logImpression(b.impression())}),[g,b]);var y=(0,s.useState)(!1),C=(0,a.A)(y,2),k=C[0],S=C[1],R=function(){k||g.logInteraction(b.addFriendButtonFactory().hitUiReveal()),S(!k)},E=0===i.length,w=(0,s.useCallback)((function(){g.logInteraction(b.closeButtonFactory().hitUiHide())}),[g,b]);return(0,W.jsx)(v.ql.Provider,{value:"buddy_feed",children:(0,W.jsx)(o._,{label:l.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,W.jsxs)(Bi,{page:k?1:0,nodeRef:k?N:p,children:[(0,W.jsx)("div",{className:ke,ref:N,children:(0,W.jsx)(ge,{onBackButtonClick:R,feedIsEmpty:E,goToAddFriends:k})}),(0,W.jsx)("div",{className:Se,ref:p,children:(0,W.jsxs)(u.w,{children:[(0,W.jsx)(f.a,{title:l.Ru.get("buddy-feed.friend-activity"),panel:m.Z.BuddyFeed,onClose:w,actions:(0,W.jsx)(d.Zp,{label:l.Ru.get("buddy-feed.add-friends"),children:(0,W.jsx)(c.a,{ariaLabel:l.Ru.get("buddy-feed.add-friends"),testId:"add-friends-button",size:"sm",onClick:R,icon:t.k})})}),(0,W.jsx)("div",{className:_e,children:(0,W.jsx)(c.a,{ariaLabel:l.Ru.get("buddy-feed.add-friends"),className:Fe,size:"sm",onClick:R,icon:t.k})}),E?(0,W.jsx)(Xe,{}):(0,W.jsx)(Ci,{friends:i,spec:b})]})})]})})})}}}]);
=======
"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[4338],{67731:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Ls});var i=a(50959),t=a(74979),n=a(15880),l=a(85648),r=a(55842),d=a(12618),c=a(13481),o=a(58800),u=a(83335),m=a(54941),x=a(13734),f=a(2800),g=a(80626),h=(a(86277),a(80199)),j=a(82187),b=a.n(j),y=a(69736),p=a(11317),N=a(87608),v=a(82579),k=a(16972),C=a(27838),L=a(33981),I=a(75463),E=a(86696),S=a(41736),w=a(60046),O=a(43316),T=a(17053),U=a(33598),A=a(45438),D=a(22527),M=a(82857),B=a(64169),_=a(70488),F=a(11527);const P=e=>{const{timestamp:s,isNowPlaying:a}=e;return a?(0,F.jsx)(d.ws,{label:l.ag.get("time.now"),children:(0,F.jsx)(B.h,{"aria-label":l.ag.get("time.now"),size:"small"})}):(0,F.jsx)("span",{children:(0,_.l)(s)})},z="main-buddyFeed-friendActivity",J="VLKqDIGaQn2bILzJKSZ0",Y="main-buddyFeed-friendsFeedContainer",K="main-buddyFeed-avatarContainer",Z="main-buddyFeed-overlay",q="main-buddyFeed-playIcon",H="main-buddyFeed-activityMetadata",R="main-buddyFeed-usernameAndTimestamp",W="main-buddyFeed-username",V="main-buddyFeed-timestamp",Q="main-buddyFeed-artistAndTrackName",G="main-buddyFeed-playbackContextIcon",X="main-buddyFeed-playbackContext",$="main-buddyFeed-playbackContextLink",ee="main-buddyFeed-addFriendPlaceholder",se="main-buddyFeed-addFriendPlaceholderBtn",ae="main-buddyFeed-emptyBuddyFeed",ie="main-buddyFeed-addFriendPlaceholderText",te="PjDcsgAPmXlcTBJRGpIu",ne="IRpPQFA57qgQ5jicWWaD",le="Hm3nIbegLclY1uCAmnx_",re="bhRoVUHjWdo9mgUkU6fe",de="BliqfY7vu_qE2C9zs5Ou",ce="qdYWuHZd4HdSWfd4pSQB",oe="DhvYWKjDc7uyF3HfkDJJ",ue="ralK8s_OmE8a8zWcfNKM",me=e=>Date.now()-e<9e5,xe=(e,s)=>{const a=(0,p.EC)(e)?.type;switch(a){case p.JM.PLAYLIST:case p.JM.PLAYLIST_V2:return(0,F.jsx)(L.X,{uri:e});case p.JM.EPISODE:case p.JM.SHOW:return(0,F.jsx)(I.M,{uri:e});case p.JM.ALBUM:return(0,F.jsx)(k.Y,{uri:e,artistUri:s});case p.JM.ARTIST:return(0,F.jsx)(C.m,{uri:e});default:return null}},fe=e=>{switch(e){case p.JM.ALBUM:return M.p.ALBUM;case p.JM.ARTIST:return M.p.ARTIST;case p.JM.SHOW:return M.p.SHOW;case p.JM.EPISODE:return M.p.EPISODE;case p.JM.PLAYLIST:case p.JM.PLAYLIST_V2:return M.p.PLAYLIST;default:return}},ge=e=>{const{show:s=!0,spec:a,friend:t}=e,n=(0,i.useMemo)((()=>t.user.imageUrl?[{url:t.user.imageUrl,width:0,height:0}]:[]),[t.user.imageUrl]),r=(0,x.o)(),d=(0,g.$P)(),c=t.track,o=c.uri,{togglePlay:u,isPlaying:m,isActive:f}=(0,D.n)({uri:o},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),h=(0,p.EC)(c.context?.uri),j=h?.type,k=(0,i.useCallback)((()=>{u(),r({intent:m?"pause":"play",type:"click",itemIdSuffix:"buddyfeed_play",targetUri:o});const e=a.friendRowFactory().playButtonFactory();f?m?d.logInteraction(e.hitPause({itemToBePaused:o})):d.logInteraction(e.hitResume({itemToBeResumed:o})):d.logInteraction(e.hitPlay({itemToBePlayed:o}))}),[r,m,o,a,f,u,d]),L=(0,i.useCallback)(((e,s)=>{d.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:e}).hitUiNavigate({destination:s}))}),[d,a]),I=(0,T.O)({itemUris:[o],dragLabelText:c.name}),M=(0,T.O)({itemUris:[c.artist?.uri],dragLabelText:c.artist?.name}),B=(0,T.O)({itemUris:[c.context?.uri],dragLabelText:c.context?.name});return s?(0,F.jsxs)("div",{className:b()(z),children:[(0,F.jsx)(v._,{menu:xe(c.context?.uri,c.artist?.uri),children:(0,F.jsxs)("div",{className:K,children:[(0,F.jsx)(N.q,{label:t.user.name,width:40,userIconSize:"small",images:n,withBadge:me(t.timestamp)}),(0,F.jsx)(O.I,{className:Z,iconClassName:q,isPlaying:m,isLocked:!1,onClick:k,playAriaLabel:m?l.ag.get("pause"):`${l.ag.get("play")} ${c.artist.name} ${c.name}`})]})}),(0,F.jsxs)("div",{className:b()(H),children:[(0,F.jsxs)("div",{className:R,children:[(0,F.jsx)(y.x,{as:"p",variant:"bodySmallBold",className:b()(W,"ellipsis-one-line"),children:(0,F.jsx)(A.JL,{value:"/buddyfeed_user_profile",children:(0,F.jsx)(v._,{menu:(0,F.jsx)(S.I,{uri:t.user.uri}),children:(0,F.jsx)(w.Link,{title:t.user.name,to:t.user.uri,dir:"auto",onClick:()=>L("profile_link",t.user.uri),children:t.user.name})})})}),(0,F.jsx)(y.x,{as:"p",variant:"marginal",className:b()(V),children:(0,F.jsx)(P,{timestamp:t.timestamp,isNowPlaying:me(t.timestamp)})})]}),(0,F.jsxs)(y.x,{as:"p",variant:"marginal",className:Q,children:[(0,F.jsx)(A.JL,{value:"/buddyfeed_track",children:(0,F.jsx)(v._,{menu:(0,F.jsx)(E.$,{uri:c.uri,contextUri:c.context?.uri,albumUri:c.album?.uri,artists:[c.artist]}),children:(0,F.jsx)(w.Link,{title:c.name,to:o,className:"ellipsis-one-line",dir:"auto",draggable:!0,onDragStart:I,onClick:()=>L("track_link",o),children:c.name})})}),(0,F.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,F.jsx)(A.JL,{value:"/buddyfeed_artist",children:(0,F.jsx)(v._,{menu:c.artist?(0,F.jsx)(C.m,{uri:c.artist.uri}):null,children:(0,F.jsx)(w.Link,{title:c.artist?.name,to:c.artist?.uri,className:"ellipsis-one-line",dir:"auto",draggable:!0,onDragStart:M,onClick:()=>L("artist_link",c.artist?.uri),children:c.artist?.name})})})]}),(0,F.jsx)(y.x,{as:"p",variant:"marginal",className:b()("ellipsis-one-line",X),children:(0,F.jsx)(A.JL,{value:"/buddyfeed_context",children:(0,F.jsx)(v._,{menu:xe(c.context?.uri,c.artist?.uri),children:(0,F.jsxs)(w.Link,{title:c.context?.name,to:c.context?.uri,className:$,draggable:!0,onDragStart:B,onClick:()=>L("context_link",c.context?.uri),children:[(0,F.jsx)(U.t,{type:fe(j),iconSize:16,className:G}),(0,F.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:c.context?.name})]})})})})]})]},t.user.uri):null};function he({friends:e,spec:s}){return(0,F.jsx)(h.U5,{flipKey:e.map((e=>e.user.uri)).join(""),children:(0,F.jsx)("ol",{children:e.map(((e,a)=>(0,F.jsx)(h.$3,{flipId:e.user.uri,children:(0,F.jsx)("li",{children:(0,F.jsx)(ge,{friend:e,show:a<100,spec:s},e.user.uri)})},e.user.uri)))})})}var je=a(92075),be=a(3533),ye=a(29380),pe=a(97154),Ne=a(39505),ve=(a(46758),a(53321),a(49857)),ke=a(45540),Ce=a(7863),Le=a(61408),Ie=a(394),Ee=a(60637);const Se="w5nHQ74JGTytKwWanjvB",we="u11kJflcqt7CSXo9qL_T",Oe="MmENkh6tW0MyjTtTtPHZ",Te="Gl0dkNQbAyNjVZ1IpghI",Ue=({name:e,following:s,imageUrl:a,uri:n})=>{const d=(0,Ie.q)(),c=(0,x.o)(),o=i.createRef(),[u,m]=(0,i.useState)(s);(0,Ee.d)(Le.rA.OPERATION_COMPLETE,(e=>{if(e.data.uris.includes(n))switch(e.data.operation){case Le.BM.FOLLOW_USER:m(!0);break;case Le.BM.UNFOLLOW_USER:m(!1)}}));const f=(0,i.useCallback)((()=>{u?d.unfollowUsers([n]):(d.followUsers([n]),c({intent:"follow",type:"click",itemIdSuffix:"buddyfeed"})),o.current&&o.current.blur()}),[u,o,n,d,c]);return(0,i.useEffect)((()=>{m(s)}),[s]),(0,F.jsxs)("div",{className:Se,children:[(0,F.jsx)(N.q,{label:e,width:40,userIconSize:"small",images:(0,i.useMemo)((()=>[{width:40,height:40,url:a}]),[a])}),(0,F.jsxs)("div",{className:b()(we,"ellipsis-one-line"),children:[(0,F.jsx)(y.x,{as:"p",variant:"bodySmallBold",className:"ellipsis-one-line",children:e}),u&&(0,F.jsx)(y.x,{as:"p",variant:"marginal",className:"ellipsis-one-line",children:l.ag.get("following")})]}),(0,F.jsx)("div",{className:Oe,children:(0,F.jsx)(r.E,{className:Te,size:"sm",ref:o,onClick:f,ariaLabel:u?l.ag.get("buddy-feed.button.remove-friend"):l.ag.get("buddy-feed.button.add-friend"),icon:u?Ce.k:t.t})})]})},Ae="main-buddyFeed-friendsList";function De({facebookFriends:e}){return(0,F.jsx)("div",{className:Ae,children:e.map((({uri:e,following:s,title:a,image:i})=>(0,F.jsx)(Ue,{uri:e,name:a,imageUrl:i,following:s},`fb-friend-${e}`)))})}var Me=a(56839);const Be="main-buddyFeed-loadingFriends";function _e(){return(0,F.jsx)("div",{className:Be,children:Array(20).fill(0).map(((e,s)=>(0,F.jsx)(Me.C,{isLoading:!0,charCount:100,as:"p",variant:"titleSmall"},s)))})}var Fe=a(41194),Pe=a(1494);const ze="pZFwflwH1vXVCmAO5vbz",Je="yPL55nV5rC97vJhAf7ke",Ye="qpgo9DQ9rVZbO5pLJog5",Ke="A3hvkJOGkBNa6zWj6oZa",Ze="pIyez6N1SF3jW0U5VUx4",qe="lIxuZR4lYTrEKkMYedty",He="VEmC3OHK3uAasHvO5OuA",Re="wzGPtuvvLpOpY1PDu4Qv",We="YoJTUV4hazVCFNbfKoNq",Ve=({onBackButtonClick:e})=>{const[s,a]=(0,i.useState)(""),{isLoading:t,friends:n}=(e=>{const s=(0,Pe.I)(),a=e.trim().toLowerCase(),{data:i,isLoading:t}=(0,Fe.a)({queryKey:["useFacebookFriends"],queryFn:async()=>(await s.fetchFacebookFriends()).sort(((e,s)=>e.title>s.title?1:-1))});return{isLoading:t,friends:i?.filter((({title:e})=>-1!==e.trim().toLowerCase().indexOf(a)))??[]}})(s),d=(0,ve.y1)((e=>{a(e.target.value)}),100),c=(0,i.useCallback)((e=>{null!==e&&e.focus()}),[]);return(0,F.jsxs)("div",{className:ze,children:[(0,F.jsx)(r.E,{ariaLabel:l.ag.get("buddy-feed.button.back"),onClick:e,ref:c,className:Je,icon:je.e,size:"sm",testId:"back-to-friends"}),(0,F.jsxs)("div",{className:Ye,children:[(0,F.jsx)("div",{className:Ke,children:(0,F.jsx)(ye.z,{className:Ze,size:"large"})}),(0,F.jsx)("div",{className:qe,children:t?(0,F.jsx)(Me.C,{isLoading:!0,charCount:25,as:"p",variant:"bodySmall"}):(0,F.jsx)(y.x,{as:"p",variant:"bodySmall",children:l.ag.get("buddy-feed.number-of-friends",n.length)})})]}),t?(0,F.jsx)(_e,{}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)("div",{className:He,children:[(0,F.jsx)(ke.j,{className:We,size:"small",role:"presentation"}),(0,F.jsx)("input",{onChange:d,className:Re,placeholder:l.ag.get("buddy-feed.find-in-playlists")})]}),(0,F.jsx)(De,{facebookFriends:n})]})]})};var Qe=a(29608);function Ge({isOpen:e,onClose:s,onConfirm:a}){return(0,F.jsx)(Qe.Q,{onClose:s,"aria-label":l.ag.get("web-player.buddy-feed.connect-with-facebook-title"),onConfirm:a,titleText:l.ag.get("web-player.buddy-feed.connect-with-facebook-title"),descriptionText:l.ag.get("web-player.buddy-feed.connect-with-facebook-description"),cancelText:l.ag.get("queue.cancel-button"),confirmText:l.ag.get("web-player.buddy-feed.connect-button"),isOpen:e})}let Xe=function(e){return e[e.LOADING=0]="LOADING",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e}({});const $e="EmZCbU1_B_J9RAHebolL",es="Ym6Yyx83U7mNKOMw9dxw",ss="NXcZaSipzomJ6d4_nM94",as="b9rqRkvRvhrSY4FYHQVC",is="xHc_2FQr3NxfCgfDSVhY",ts="QAJYN0xWh3h2A5d8_C1g",ns="PKhH1CknobkjJdVITsb4",ls="HgRmCE3NxfiYNtv6pF3H",rs="HnA5mipUMkheAlbxqCn_",ds="mvp0xhvZTo0xv0TIwi9u",cs=e=>{const s=(0,x.o)(),{onBackButtonClick:a,feedIsEmpty:t,goToAddFriends:n=!1}=e,d=function(){const e=(0,Pe.I)(),[s,a]=(0,i.useState)(Xe.LOADING);return(0,i.useEffect)((()=>e.subscribeToFacebookConnectionState((e=>{a(e.connection?Xe.CONNECTED:Xe.DISCONNECTED)})).cancel),[e]),s}(),c=(0,Pe.I)(),[o,u]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),[g,h]=(0,i.useState)(!1),j=(0,i.useCallback)((e=>{null!==e&&e.focus()}),[]),b=(0,i.useCallback)((()=>{location.reload()}),[]);if(m)return(0,F.jsxs)("div",{className:rs,children:[(0,F.jsx)(r.E,{onClick:a,ref:j,className:ss,ariaLabel:l.ag.get("buddy-feed.button.back"),icon:je.e,size:"sm"}),(0,F.jsxs)("div",{className:ds,children:[(0,F.jsx)(y.x,{as:"h1",variant:"bodyMediumBold",className:es,children:l.ag.get("error-dialog.generic.header")}),(0,F.jsx)(y.x,{as:"p",variant:"bodySmall",className:as,children:l.ag.get("error-dialog.generic.body")}),(0,F.jsx)(be.D,{colorSet:"invertedLight",onClick:b,children:l.ag.get("error.reload")})]})]});const p=(n||g)&&d===Xe.CONNECTED;return(0,F.jsxs)("div",{className:$e,children:[p&&(0,F.jsx)(Ve,{onBackButtonClick:()=>{t&&h(!1),a()}}),!p&&(0,F.jsxs)("div",{className:ts,children:[(0,F.jsx)(r.E,{ariaLabel:l.ag.get("buddy-feed.button.back"),onClick:a,className:ss,ref:j,icon:je.e,size:"sm"}),(0,F.jsx)(y.x,{as:"h1",variant:"bodyMediumBold",className:es,children:l.ag.get("buddy-feed.friend-activity")}),(0,F.jsx)(y.x,{as:"p",variant:"bodySmall",className:as,children:l.ag.get("buddy-feed.facebook.connect-with-friends-default")}),(0,F.jsx)("div",{className:ns,children:(0,F.jsx)(be.D,{className:ls,size:"small",iconLeading:ye.z,UNSAFE_colorSet:(0,pe.Ev)("#2374E1",Ne.ixZ),onClick:()=>{s({intent:"connect-to-facebook",type:"click",itemIdSuffix:"buddyfeed"}),d!==Xe.CONNECTED?u(!0):h(!0)},children:l.ag.get("buddy-feed.facebook.button")})}),(0,F.jsx)(y.x,{as:"p",variant:"marginal",className:is,children:l.ag.get("buddy-feed.facebook.disclaimer")}),(0,F.jsx)(Ge,{isOpen:o,onClose:()=>{u(!1)},onConfirm:()=>{c.connectToFacebook().then((()=>{h(!0),u(!1)})).catch((()=>{f(!0)}))}})]})]})};var os=a(36275),us=a(80956);const ms=({showOnlineIndicator:e})=>(0,F.jsxs)("div",{className:te,children:[(0,F.jsxs)("div",{className:ne,children:[(0,F.jsx)(us.f,{size:"medium"}),e?(0,F.jsx)("div",{className:le}):null]}),(0,F.jsxs)("div",{className:re,children:[(0,F.jsx)("div",{className:b()(de,ce)}),(0,F.jsx)("div",{className:de}),(0,F.jsx)("div",{className:de})]})]}),xs=()=>(0,F.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:ae,children:[(0,F.jsx)(y.x,{as:"p",className:ie,children:l.ag.get("buddy-feed.let-followers-see-your-listening")}),(0,F.jsx)(ms,{showOnlineIndicator:!0}),(0,F.jsx)(ms,{showOnlineIndicator:!0}),(0,F.jsx)(ms,{}),(0,F.jsx)(y.x,{as:"p",className:ie,children:l.ag.get("buddy-feed.enable-share-listening-activity")}),(0,F.jsx)(os.rU,{to:"/preferences",className:oe,children:(0,F.jsx)(be.D,{colorSet:"invertedLight",className:ue,children:l.ag.get("desktop.settings.settings")})})]});var fs=a(35260),gs=a(81558);const hs="jUF2eKgYMm64aYykubct",js="zhL_lhJqzKfJVy7L5VuY",bs="XqquM_o2eODcnD8Y4QhS",ys="UGtycHBJ4egymBSmD_lX",ps="ND2ydDPzwQZB7HyaGCN8",Ns="D9YN554UFGJle2CPP1TA",vs="v7Zcy9UKVUTDZIMKB6ZF",ks="RX3U6eAasqazEkuFdnj0",Cs=({children:e,page:s})=>{const a=0===s,i=e.filter(((e,a)=>a!==s));return(0,F.jsx)(fs.Z,{component:null,children:i.map((e=>(0,F.jsx)(gs.Z,{in:a,timeout:500,classNames:{enter:a?hs:ps,enterActive:a?js:Ns,exit:a?bs:vs,exitActive:a?ys:ks},children:e},a?"first-page":"second-page")))})},Ls=({friends:e})=>{const s=(0,x.o)(),a=(0,g.$P)(),{spec:h}=(0,g.fU)(n.J,{});(0,i.useEffect)((()=>{s({intent:"view",type:"impression",itemIdSuffix:"buddyfeed"})}),[s]),(0,i.useEffect)((()=>{a.logImpression(h.impression())}),[a,h]);const[j,b]=(0,i.useState)(!1),y=()=>{j||a.logInteraction(h.addFriendButtonFactory().hitUiReveal()),b(!j)},p=0===e.length,N=(0,i.useCallback)((()=>{a.logInteraction(h.closeButtonFactory().hitUiHide())}),[a,h]);return(0,F.jsx)(f.DJ.Provider,{value:"buddy_feed",children:(0,F.jsx)(c.l,{label:l.ag.get("buddy-feed.friend-activity"),children:(0,F.jsxs)(Cs,{page:j?1:0,children:[(0,F.jsx)("div",{className:J,children:(0,F.jsx)(cs,{onBackButtonClick:y,feedIsEmpty:p,goToAddFriends:j})}),(0,F.jsx)("div",{className:Y,children:(0,F.jsxs)(o.K,{children:[(0,F.jsx)(u.V,{title:l.ag.get("buddy-feed.friend-activity"),panel:m.s.BuddyFeed,onClose:N,actions:(0,F.jsx)(d.ws,{label:l.ag.get("buddy-feed.add-friends"),children:(0,F.jsx)(r.E,{ariaLabel:l.ag.get("buddy-feed.add-friends"),testId:"add-friends-button",size:"sm",onClick:y,icon:t.t})})}),(0,F.jsx)("div",{className:ee,children:(0,F.jsx)(r.E,{ariaLabel:l.ag.get("buddy-feed.add-friends"),className:se,size:"sm",onClick:y,icon:t.t})}),p?(0,F.jsx)(xs,{}):(0,F.jsx)(he,{friends:e,spec:h})]})})]})})})}}}]);
>>>>>>> origin/master
//# sourceMappingURL=xpui-routes-buddy-feed.js.map